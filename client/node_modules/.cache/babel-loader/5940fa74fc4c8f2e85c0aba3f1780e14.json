{"ast":null,"code":"import _regeneratorRuntime from\"/Users/albertshay/Desktop/silkroad/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/albertshay/Desktop/silkroad/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/albertshay/Desktop/silkroad/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useRef}from'react';import{Typography,TextField,Button}from'@material-ui/core/';import{useDispatch}from'react-redux';import{useHistory}from'react-router-dom';import{commentPost}from'../../actions/posts';import useStyles from'./styles';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CommentSection=function CommentSection(_ref){var post=_ref.post;var user=JSON.parse(localStorage.getItem('profile'));var _useState=useState(''),_useState2=_slicedToArray(_useState,2),comment=_useState2[0],setComment=_useState2[1];var dispatch=useDispatch();var _useState3=useState(post===null||post===void 0?void 0:post.comments),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComments=_useState4[1];var history=useHistory();var classes=useStyles();var commentsRef=useRef();var handleComment=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _user$result,_commentsRef$current,newComments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(user===null||user===void 0?void 0:user.token){_context.next=4;break;}history.push('/auth');_context.next=10;break;case 4:_context.next=6;return dispatch(commentPost(\"\".concat(user===null||user===void 0?void 0:(_user$result=user.result)===null||_user$result===void 0?void 0:_user$result.name,\": \").concat(comment),post._id));case 6:newComments=_context.sent;setComment('');setComments(newComments);commentsRef===null||commentsRef===void 0?void 0:(_commentsRef$current=commentsRef.current)===null||_commentsRef$current===void 0?void 0:_commentsRef$current.scrollIntoView({behavior:'smooth'});case 10:case\"end\":return _context.stop();}}},_callee);}));return function handleComment(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:classes.commentsOuterContainer,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.commentsInnerContainer,children:[/*#__PURE__*/_jsx(Typography,{gutterBottom:true,variant:\"h7\",className:classes.messages,children:\"Messages:\"}),comments===null||comments===void 0?void 0:comments.map(function(c,i){return/*#__PURE__*/_jsxs(Typography,{className:classes.messageDetails,gutterBottom:true,variant:\"subtitle1\",children:[/*#__PURE__*/_jsx(\"strong\",{className:classes.messageName,children:c.split(\": \")[0]}),\": \",c.split(\":\")[1]]},i);}),/*#__PURE__*/_jsx(\"div\",{ref:commentsRef})]}),/*#__PURE__*/_jsxs(\"div\",{style:{width:'70%'},children:[/*#__PURE__*/_jsx(Typography,{className:classes.leaveMessage,gutterBottom:true,variant:\"h7\",children:\"Leave a message\"}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,rows:10,variant:\"outlined\",label:\"leave message...\",multiline:true,value:comment,onChange:function onChange(e){return setComment(e.target.value);},InputProps:{classes:{root:classes.inputRoot}},InputLabelProps:{classes:{root:classes.labelRoot,focused:classes.labelFocused}},margin:\"normal\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Button,{className:classes.buttonMessage,style:{marginTop:'10px'},fullWidth:true,disabled:!comment.length,color:\"primary\",variant:\"contained\",onClick:handleComment,children:\"Message\"})]})]})});};export default CommentSection;","map":{"version":3,"sources":["/Users/albertshay/Desktop/silkroad/client/src/components/PostDetails/CommentSection.jsx"],"names":["React","useState","useRef","Typography","TextField","Button","useDispatch","useHistory","commentPost","useStyles","CommentSection","post","user","JSON","parse","localStorage","getItem","comment","setComment","dispatch","comments","setComments","history","classes","commentsRef","handleComment","token","push","result","name","_id","newComments","current","scrollIntoView","behavior","commentsOuterContainer","commentsInnerContainer","messages","map","c","i","messageDetails","messageName","split","width","leaveMessage","e","target","value","root","inputRoot","labelRoot","focused","labelFocused","buttonMessage","marginTop","length"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from 'react';\nimport { Typography, TextField, Button } from '@material-ui/core/';\nimport { useDispatch } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport { commentPost } from '../../actions/posts';\nimport useStyles from './styles';\n\nconst CommentSection = ({ post }) => {\n  const user = JSON.parse(localStorage.getItem('profile'));\n  const [comment, setComment] = useState('');\n  const dispatch = useDispatch();\n\n  const [comments, setComments] = useState(post?.comments);\n  const history = useHistory();\n  const classes = useStyles();\n  const commentsRef = useRef();\n\n  const handleComment = async () => {\n    if (!user?.token) {\n      history.push('/auth');\n    } else {\n      const newComments = await dispatch(\n        commentPost(`${user?.result?.name}: ${comment}`, post._id)\n      );\n\n      setComment('');\n      setComments(newComments);\n\n      commentsRef?.current?.scrollIntoView({ behavior: 'smooth' });\n    }\n  };\n\n  return (\n    <div>\n      <div className={classes.commentsOuterContainer}>\n        <div className={classes.commentsInnerContainer}>\n          <Typography gutterBottom variant='h7' className={classes.messages}>\n            Messages:\n          </Typography>\n          {comments?.map((c, i) => (\n            <Typography\n              key={i}\n              className={classes.messageDetails}\n              gutterBottom\n              variant='subtitle1'\n            >\n              <strong className={classes.messageName}>\n                {c.split(`: `)[0]}\n              </strong>\n              : {c.split(`:`)[1]}\n            </Typography>\n          ))}\n          <div ref={commentsRef} />\n        </div>\n        <div style={{ width: '70%' }}>\n          <Typography\n            className={classes.leaveMessage}\n            gutterBottom\n            variant='h7'\n          >\n            Leave a message\n          </Typography>\n          <TextField\n            fullWidth\n            rows={10}\n            variant='outlined'\n            label='leave message...'\n            multiline\n            value={comment}\n            onChange={(e) => setComment(e.target.value)}\n            InputProps={{ classes: { root: classes.inputRoot } }}\n            InputLabelProps={{\n              classes: {\n                root: classes.labelRoot,\n                focused: classes.labelFocused,\n              },\n            }}\n            margin='normal'\n          />\n          <br />\n          <Button\n            className={classes.buttonMessage}\n            style={{ marginTop: '10px' }}\n            fullWidth\n            disabled={!comment.length}\n            color='primary'\n            variant='contained'\n            onClick={handleComment}\n          >\n            Message\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n};\nexport default CommentSection;\n"]},"metadata":{},"sourceType":"module"}