{"ast":null,"code":"import _toConsumableArray from\"/Users/albertshay/Desktop/silkroad/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/albertshay/Desktop/silkroad/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{Container,Grow,Grid,Paper,AppBar,BottomNavigation,TextField,Button}from'@material-ui/core';import{useDispatch,useSelector}from'react-redux';import{useHistory,useLocation}from'react-router-dom';import{getPlacesData,getWeatherData}from'../../api/travelAdvisorAPI';// import ChipInput from 'material-ui-chip-input';\nimport{getPosts,getPostsBySearch,getPostsByUser}from'../../actions/posts';import Pagination from'../Pagination';import Posts from'../Posts/Posts';//import Map from '../Map/Map';\nimport ChipInput from'material-ui-chip-input';import Form from'../Form/Form';import ModalUnstyledDemo from'../Modal/Modal';import useStyles from'./styles';import AddBoxIcon from'@mui/icons-material/AddBox';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function useQuery(){return new URLSearchParams(useLocation().search);}var scrollToRef=function scrollToRef(ref){return window.scrollTo(0,ref.current.offsetTop);};var Home=function Home(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),currentId=_useState4[0],setCurrentId=_useState4[1];var dispatch=useDispatch();var query=useQuery();var history=useHistory();var page=query.get('page')||1;var searchQuery=query.get('searchQuery');var classes=useStyles();var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),search=_useState6[0],setSearch=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),tags=_useState8[0],setTags=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),location=_useState10[0],setLocation=_useState10[1];var myRef=useRef(null);var _useSelector=useSelector(function(state){return state.posts;}),posts=_useSelector.posts,isLoading=_useSelector.isLoading;//end of map feature\n// useEffect(() => {\n//   dispatch(getPosts());\n// }, [currentId, dispatch]);\nvar searchPost=function searchPost(){if(search.trim()){//to have something to dispatch we need to create the action 'getPostsBySearch\n//dispatch -> fetch search post\ndispatch(getPostsBySearch({search:search,tags:tags.join(',')}));// history.push(`/posts/search?searchQuery=${search || 'none'}`);\nhistory.push(\"/posts/search?searchQuery=\".concat(search||'none',\"&tags=\").concat(tags.join(',')));}else{history.push('/');}};var searchByUser=function searchByUser(){var user=JSON.parse(localStorage.getItem('profile'));if(user)dispatch(getPostsByUser(user.result._id));history.push(\"/posts/user/\");console.log(user);};var handleKeyPress=function handleKeyPress(e){if(e.keycode===13){searchPost();// search post\n}};var handleAddChip=function handleAddChip(tag){return setTags([].concat(_toConsumableArray(tags),[tag]));};var handleDeleteChip=function handleDeleteChip(chipToDelete){return setTags(tags.filter(function(tag){return tag!==chipToDelete;}));};var showHideClassName=show?classes.inputFormShow:classes.inputFormHide;var executeScroll=function executeScroll(){return scrollToRef(myRef);};var showModal=function showModal(){setShow(!show);executeScroll();};// const hideModal = () => {\n//   setShow(false);\n// };\nreturn/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{ref:myRef,className:showHideClassName,children:/*#__PURE__*/_jsx(Grid,{item:true,xs:16,sm:9,md:12,className:classes.centerForm,children:/*#__PURE__*/_jsx(Form,{currentId:currentId,setCurrentId:setCurrentId,showModal:showModal,location:location,setLocation:setLocation})})}),/*#__PURE__*/_jsx(AppBar,{className:classes.addBar,position:\"fixed\",color:\"inherit\",elevation:0,children:/*#__PURE__*/_jsx(AddBoxIcon,{className:classes.addIcon,type:\"button\",fontSize:\"large\",onClick:showModal})}),/*#__PURE__*/_jsx(Grow,{in:true,children:/*#__PURE__*/_jsxs(Container,{maxWidth:\"xl\",position:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,container:true,justify:\"space-between\",alignItems:\"stretch\",spacing:3,className:classes.gridContainer,children:/*#__PURE__*/_jsx(Grid,{item:true,xs:16,sm:9,md:12,children:/*#__PURE__*/_jsx(Posts,{setCurrentId:setCurrentId,showModal:showModal})})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Grid,{item:true,xs:16,sm:9,md:12,children:!searchQuery&&!tags.length&&/*#__PURE__*/_jsx(Pagination,{page:page,className:classes.pagination})})]})})]});};export default Home;","map":{"version":3,"sources":["/Users/albertshay/Desktop/silkroad/client/src/components/Home/Home.js"],"names":["React","useState","useEffect","useRef","Container","Grow","Grid","Paper","AppBar","BottomNavigation","TextField","Button","useDispatch","useSelector","useHistory","useLocation","getPlacesData","getWeatherData","getPosts","getPostsBySearch","getPostsByUser","Pagination","Posts","ChipInput","Form","ModalUnstyledDemo","useStyles","AddBoxIcon","useQuery","URLSearchParams","search","scrollToRef","ref","window","scrollTo","current","offsetTop","Home","show","setShow","currentId","setCurrentId","dispatch","query","history","page","get","searchQuery","classes","setSearch","tags","setTags","location","setLocation","myRef","state","posts","isLoading","searchPost","trim","join","push","searchByUser","user","JSON","parse","localStorage","getItem","result","_id","console","log","handleKeyPress","e","keycode","handleAddChip","tag","handleDeleteChip","chipToDelete","filter","showHideClassName","inputFormShow","inputFormHide","executeScroll","showModal","centerForm","addBar","addIcon","gridContainer","length","pagination"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport {\n  Container,\n  Grow,\n  Grid,\n  Paper,\n  AppBar,\n  BottomNavigation,\n  TextField,\n  Button,\n} from '@material-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { getPlacesData, getWeatherData } from '../../api/travelAdvisorAPI';\n// import ChipInput from 'material-ui-chip-input';\nimport {\n  getPosts,\n  getPostsBySearch,\n  getPostsByUser,\n} from '../../actions/posts';\nimport Pagination from '../Pagination';\nimport Posts from '../Posts/Posts';\n//import Map from '../Map/Map';\nimport ChipInput from 'material-ui-chip-input';\nimport Form from '../Form/Form';\nimport ModalUnstyledDemo from '../Modal/Modal';\nimport useStyles from './styles';\nimport AddBoxIcon from '@mui/icons-material/AddBox';\n\nfunction useQuery() {\n  return new URLSearchParams(useLocation().search);\n}\nconst scrollToRef = (ref) => window.scrollTo(0, ref.current.offsetTop);\nconst Home = () => {\n  const [show, setShow] = useState(false);\n  const [currentId, setCurrentId] = useState(0);\n  const dispatch = useDispatch();\n  const query = useQuery();\n  const history = useHistory();\n  const page = query.get('page') || 1;\n  const searchQuery = query.get('searchQuery');\n  const classes = useStyles();\n  const [search, setSearch] = useState('');\n  const [tags, setTags] = useState([]);\n  const [location, setLocation] = useState('');\n  const myRef = useRef(null);\n  const { posts, isLoading } = useSelector((state) => state.posts);\n\n  //end of map feature\n  // useEffect(() => {\n  //   dispatch(getPosts());\n  // }, [currentId, dispatch]);\n\n  const searchPost = () => {\n    if (search.trim()) {\n      //to have something to dispatch we need to create the action 'getPostsBySearch\n      //dispatch -> fetch search post\n      dispatch(getPostsBySearch({ search, tags: tags.join(',') }));\n      // history.push(`/posts/search?searchQuery=${search || 'none'}`);\n      history.push(\n        `/posts/search?searchQuery=${search || 'none'}&tags=${tags.join(',')}`\n      );\n    } else {\n      history.push('/');\n    }\n  };\n\n  const searchByUser = () => {\n    const user = JSON.parse(localStorage.getItem('profile'));\n    if (user) dispatch(getPostsByUser(user.result._id));\n    history.push(`/posts/user/`);\n    console.log(user);\n  };\n  const handleKeyPress = (e) => {\n    if (e.keycode === 13) {\n      searchPost();\n      // search post\n    }\n  };\n  const handleAddChip = (tag) => setTags([...tags, tag]);\n\n  const handleDeleteChip = (chipToDelete) =>\n    setTags(tags.filter((tag) => tag !== chipToDelete));\n\n  const showHideClassName = show\n    ? classes.inputFormShow\n    : classes.inputFormHide;\n\n  const executeScroll = () => scrollToRef(myRef);\n  const showModal = () => {\n    setShow(!show);\n    executeScroll();\n  };\n\n  // const hideModal = () => {\n  //   setShow(false);\n  // };\n  return (\n    <>\n      {/*hidden form*/}\n      <div ref={myRef} className={showHideClassName}>\n        <Grid item xs={16} sm={9} md={12} className={classes.centerForm}>\n          <Form\n            currentId={currentId}\n            setCurrentId={setCurrentId}\n            showModal={showModal}\n            location={location}\n            setLocation={setLocation}\n          />\n        </Grid>\n      </div>\n      <AppBar\n        className={classes.addBar}\n        position='fixed'\n        color='inherit'\n        elevation={0}\n      >\n        <AddBoxIcon\n          className={classes.addIcon}\n          type='button'\n          fontSize='large'\n          onClick={showModal}\n        />\n      </AppBar>\n\n      {/*post*/}\n      <Grow in>\n        <Container maxWidth='xl' position='center'>\n          {/*   <Grid container spacing={3} style={{ width: '100%' }}>*/}\n          <Grid\n            item\n            container\n            justify='space-between'\n            alignItems='stretch'\n            spacing={3}\n            className={classes.gridContainer}\n          >\n            <Grid item xs={16} sm={9} md={12}>\n              {/*remove line below and uncomment the line above*/}\n              {/*  <Grid item xs={12} md={6}>*/}\n              <Posts setCurrentId={setCurrentId} showModal={showModal} />\n            </Grid>\n            {/*remove map componement*/}\n            {/*map*/}\n            {/*\n            <Grid\n              item\n              xs={12}\n              md={6}\n              style={{\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n                flexDirection: 'column',\n                height: '100%',\n              }}\n            >\n            {posts?.map((post) => (\n        \n \n          <Map post={post} />\n          </Grid>\n        ))\n              <Map\n                setChildClicked={setChildClicked}\n                setBounds={setBounds}\n                setCoords={setCoords}\n                coords={coords}\n                places={location}\n              />\n            </Grid>*/}\n            {/*map componement ends here*/}\n            {/*remove grid line below*/}\n          </Grid>\n\n          <br />\n\n          {/*//pagination*/}\n          <Grid item xs={16} sm={9} md={12}>\n            {!searchQuery && !tags.length && (\n              <Pagination page={page} className={classes.pagination} />\n            )}\n          </Grid>\n        </Container>\n      </Grow>\n    </>\n  );\n};\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}